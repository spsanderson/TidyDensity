<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bootstrap Analysis • TidyDensity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TidyDensity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-features.html">Advanced Features</a></li>
    <li><a class="dropdown-item" href="../articles/bootstrap-analysis.html">Bootstrap Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/spsanderson/TidyDensity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/spsanderson/TidyDensity/blob/HEAD/vignettes/bootstrap-analysis.Rmd" class="external-link"><code>vignettes/bootstrap-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>bootstrap-analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/spsanderson/TidyDensity" class="external-link">TidyDensity</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Bootstrap resampling is a powerful statistical technique for robust
inference. TidyDensity provides integrated bootstrap functionality with
seamless visualization and analysis tools.</p>
<div class="section level2">
<h2 id="what-is-bootstrap">What is Bootstrap?<a class="anchor" aria-label="anchor" href="#what-is-bootstrap"></a>
</h2>
<div class="section level3">
<h3 id="concept">Concept<a class="anchor" aria-label="anchor" href="#concept"></a>
</h3>
<p><strong>Bootstrap resampling</strong> is a non-parametric method
for:</p>
<ul>
<li>Estimating sampling distributions</li>
<li>Calculating confidence intervals</li>
<li>Assessing parameter uncertainty</li>
<li>Making inferences without distributional assumptions</li>
</ul>
</div>
<div class="section level3">
<h3 id="how-it-works">How It Works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Resample</strong> your data with replacement</li>
<li>
<strong>Calculate</strong> statistic of interest for each
resample</li>
<li>
<strong>Repeat</strong> process many times (typically
1000-10000)</li>
<li>
<strong>Analyze</strong> distribution of bootstrap statistics</li>
</ol>
</div>
<div class="section level3">
<h3 id="when-to-use-bootstrap">When to Use Bootstrap<a class="anchor" aria-label="anchor" href="#when-to-use-bootstrap"></a>
</h3>
<ul>
<li>Unknown or complex sampling distributions</li>
<li>Small to medium sample sizes</li>
<li>When parametric assumptions are questionable</li>
<li>For robust confidence intervals</li>
<li>Complex statistics (median, trimmed mean, etc.)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-in-tidydensity">Bootstrap in TidyDensity<a class="anchor" aria-label="anchor" href="#bootstrap-in-tidydensity"></a>
</h2>
<div class="section level3">
<h3 id="main-function-tidy_bootstrap">Main Function: <code>tidy_bootstrap()</code><a class="anchor" aria-label="anchor" href="#main-function-tidy_bootstrap"></a>
</h3>
<p>Generate bootstrap samples in tidy format:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tidy_bootstrap.html">tidy_bootstrap</a></span><span class="op">(</span></span>
<span>  <span class="va">.x</span>,                    <span class="co"># Your data vector</span></span>
<span>  .num_sims <span class="op">=</span> <span class="fl">2000</span>,      <span class="co"># Number of bootstrap samples</span></span>
<span>  .proportion <span class="op">=</span> <span class="fl">0.8</span>,     <span class="co"># Proportion to sample (default = 0.8)</span></span>
<span>  .distribution_type <span class="op">=</span> <span class="st">"continuous"</span>  <span class="co"># continuous or discrete</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="return-value">Return Value<a class="anchor" aria-label="anchor" href="#return-value"></a>
</h3>
<p>Returns a tidy tibble with:</p>
<ul>
<li>
<code>sim_number</code> - Bootstrap sample identifier</li>
<li>
<code>bootstrap_samples</code> - List column of bootstrap samples of
<code>.x</code>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="basic-bootstrap-analysis">Basic Bootstrap Analysis<a class="anchor" aria-label="anchor" href="#basic-bootstrap-analysis"></a>
</h2>
<div class="section level3">
<h3 id="simple-bootstrap-example">Simple Bootstrap Example<a class="anchor" aria-label="anchor" href="#simple-bootstrap-example"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Your data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span></span>
<span></span>
<span><span class="co"># Perform bootstrap</span></span>
<span><span class="va">bootstrap_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_bootstrap.html">tidy_bootstrap</a></span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="va">data</span>,</span>
<span>  .num_sims <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bootstrap_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   sim_number bootstrap_samples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1          <span style="color: #949494;">&lt;dbl [25]&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2          <span style="color: #949494;">&lt;dbl [25]&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3          <span style="color: #949494;">&lt;dbl [25]&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 4          <span style="color: #949494;">&lt;dbl [25]&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 5          <span style="color: #949494;">&lt;dbl [25]&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 6          <span style="color: #949494;">&lt;dbl [25]&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-bootstrap-distribution">Visualizing Bootstrap Distribution<a class="anchor" aria-label="anchor" href="#visualizing-bootstrap-distribution"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Density plot of bootstrap distribution Cumulative Mean</span></span>
<span><span class="fu"><a href="../reference/bootstrap_stat_plot.html">bootstrap_stat_plot</a></span><span class="op">(</span><span class="va">bootstrap_data</span>, .value <span class="op">=</span> <span class="va">y</span>, .stat <span class="op">=</span> <span class="st">"cmean"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/bootstrap-cmean-plot-1.png" class="r-plt" alt="Line plot showing the cumulative mean of bootstrap samples over simulation numbers, demonstrating convergence of the bootstrap mean estimate" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cumulative Harmonic Mean</span></span>
<span><span class="fu"><a href="../reference/bootstrap_stat_plot.html">bootstrap_stat_plot</a></span><span class="op">(</span><span class="va">bootstrap_data</span>, .value <span class="op">=</span> <span class="va">y</span>, .stat <span class="op">=</span> <span class="st">"chmean"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/bootstrap-chmean-plot-1.png" class="r-plt" alt="Line plot showing the cumulative harmonic mean of bootstrap samples over simulation numbers" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show Groups</span></span>
<span><span class="fu"><a href="../reference/bootstrap_stat_plot.html">bootstrap_stat_plot</a></span><span class="op">(</span><span class="va">bootstrap_data</span>, .value <span class="op">=</span> <span class="va">y</span>, .stat <span class="op">=</span> <span class="st">"cmean"</span>,</span>
<span>                    .show_groups <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/bootstrap-groups-plot-1.png" class="r-plt" alt="Line plot showing cumulative mean with individual simulation groups displayed, illustrating the variability across bootstrap samples" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="quick-statistics">Quick Statistics<a class="anchor" aria-label="anchor" href="#quick-statistics"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get basic statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bootstrap_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   10.40   15.50   19.20   20.12   22.80   33.90</span></span>
<span></span>
<span><span class="co"># Count simulations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">bootstrap_data</span><span class="op">$</span><span class="va">sim_number</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-statistics">Bootstrap Statistics<a class="anchor" aria-label="anchor" href="#bootstrap-statistics"></a>
</h2>
<div class="section level3">
<h3 id="unnesting-bootstrap-data">Unnesting Bootstrap Data<a class="anchor" aria-label="anchor" href="#unnesting-bootstrap-data"></a>
</h3>
<p>Use <code><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl()</a></code> to work with bootstrap
samples:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unnest the bootstrap data</span></span>
<span><span class="va">unnested</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now you can calculate statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">unnested</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   sim_number     y</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1           15  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1           10.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1           30.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1           15.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1           22.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1           19.2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-bootstrap-statistics">Calculating Bootstrap Statistics<a class="anchor" aria-label="anchor" href="#calculating-bootstrap-statistics"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate statistics for each bootstrap sample</span></span>
<span><span class="va">bootstrap_stats</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim_number</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    q25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    q75 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.75</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># View distribution of means</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bootstrap_stats</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   16.47   19.34   20.09   20.12   20.91   24.79</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">bootstrap_stats</span><span class="op">$</span><span class="va">mean</span>, main <span class="op">=</span> <span class="st">"Bootstrap Distribution of Mean"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Mean"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/calc-bootstrap-stats-1.png" class="r-plt" alt="Histogram of bootstrap means showing the sampling distribution of the mean statistic across 2000 bootstrap samples" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="overall-bootstrap-statistics">Overall Bootstrap Statistics<a class="anchor" aria-label="anchor" href="#overall-bootstrap-statistics"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate overall statistics from all bootstrap samples</span></span>
<span><span class="va">overall_stats</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    sd_est <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    median_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">overall_stats</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   mean_est sd_est median_est</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     20.1   5.94       19.2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="confidence-intervals">Confidence Intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h2>
<div class="section level3">
<h3 id="bootstrap-percentile-method">Bootstrap Percentile Method<a class="anchor" aria-label="anchor" href="#bootstrap-percentile-method"></a>
</h3>
<p>Most common and intuitive method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate 95% confidence intervals</span></span>
<span><span class="va">ci_level</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">ci_level</span></span>
<span></span>
<span><span class="va">bootstrap_ci</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    lower_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    upper_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    point_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">bootstrap_ci</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   lower_ci upper_ci point_estimate</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     10.4     33.9           20.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="confidence-intervals-for-multiple-statistics">Confidence Intervals for Multiple Statistics<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-multiple-statistics"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate CI for mean, median, and sd</span></span>
<span><span class="va">ci_stats</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim_number</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">median</span>, <span class="va">sd</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        lower <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        estimate <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        upper <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">ci_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; $ mean_lower      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17.6837</span></span>
<span><span class="co">#&gt; $ mean_estimate   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20.11925</span></span>
<span><span class="co">#&gt; $ mean_upper      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 22.5564</span></span>
<span><span class="co">#&gt; $ median_lower    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 16.4</span></span>
<span><span class="co">#&gt; $ median_estimate <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 19.28125</span></span>
<span><span class="co">#&gt; $ median_upper    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21.4025</span></span>
<span><span class="co">#&gt; $ sd_lower        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.104046</span></span>
<span><span class="co">#&gt; $ sd_estimate     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.879158</span></span>
<span><span class="co">#&gt; $ sd_upper        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 7.384673</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-confidence-intervals">Visualizing Confidence Intervals<a class="anchor" aria-label="anchor" href="#visualizing-confidence-intervals"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create visualization</span></span>
<span><span class="va">unnested</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">unnested</span><span class="op">$</span><span class="va">y</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">unnested</span><span class="op">$</span><span class="va">y</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">unnested</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"darkblue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Bootstrap Distribution with 95% CI"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Bootstrap Statistic"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/ci-visualization-1.png" class="r-plt" alt="Density plot of bootstrap distribution with vertical dashed red lines indicating the 2.5% and 97.5% percentiles for the 95% confidence interval, and a solid blue line showing the mean" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-augmentation-functions">Bootstrap Augmentation Functions<a class="anchor" aria-label="anchor" href="#bootstrap-augmentation-functions"></a>
</h2>
<div class="section level3">
<h3 id="augment-density">Augment Density<a class="anchor" aria-label="anchor" href="#augment-density"></a>
</h3>
<p>Add density calculations to bootstrap data:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Augment with density information</span></span>
<span><span class="va">augmented_density</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_density_augment.html">bootstrap_density_augment</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">augmented_density</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   sim_number     x     y    dx        dy</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1              1  15    1.30 0.000<span style="text-decoration: underline;">059</span>3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1              2  10.4  3.04 0.000<span style="text-decoration: underline;">286</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1              3  30.4  4.78 0.001<span style="text-decoration: underline;">02</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1              4  15.2  6.51 0.002<span style="text-decoration: underline;">79</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1              5  22.8  8.25 0.006<span style="text-decoration: underline;">24</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1              6  19.2  9.99 0.012<span style="text-decoration: underline;">4</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="augment-probability">Augment Probability<a class="anchor" aria-label="anchor" href="#augment-probability"></a>
</h3>
<p>Add cumulative probability:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Augment with probability information</span></span>
<span><span class="va">augmented_prob</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_p_augment.html">bootstrap_p_augment</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">augmented_prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sim_number     y      p</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1           15   0.186 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1           10.4 0.061<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1           30.4 0.937 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1           15.2 0.249 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1           22.8 0.779 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1           19.2 0.530</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="augment-quantile">Augment Quantile<a class="anchor" aria-label="anchor" href="#augment-quantile"></a>
</h3>
<p>Add quantile information:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Augment with quantile information</span></span>
<span><span class="va">augmented_quantile</span> <span class="op">&lt;-</span> <span class="va">bootstrap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_q_augment.html">bootstrap_q_augment</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">augmented_quantile</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sim_number     y     q</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1           15    10.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1           10.4  10.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1           30.4  10.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1           15.2  10.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1           22.8  10.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1           19.2  10.4</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-bootstrap-techniques">Advanced Bootstrap Techniques<a class="anchor" aria-label="anchor" href="#advanced-bootstrap-techniques"></a>
</h2>
<div class="section level3">
<h3 id="bootstrap-for-difference-of-means">Bootstrap for Difference of Means<a class="anchor" aria-label="anchor" href="#bootstrap-for-difference-of-means"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two groups</span></span>
<span><span class="va">group1</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">group2</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Bootstrap function for difference</span></span>
<span><span class="va">bootstrap_diff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_sims</span> <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_sims</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">boot_g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">group1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">group1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">boot_g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">group2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">group2</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">diffs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_g1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run bootstrap</span></span>
<span><span class="va">diff_dist</span> <span class="op">&lt;-</span> <span class="fu">bootstrap_diff</span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate CI</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">diff_dist</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      2.5%     97.5% </span></span>
<span><span class="co">#&gt;  3.827439 10.924939</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">diff_dist</span>, main <span class="op">=</span> <span class="st">"Bootstrap Distribution of Difference in Means"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Difference in Means"</span>, breaks <span class="op">=</span> <span class="fl">50</span>, col <span class="op">=</span> <span class="st">"lightgreen"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">diff_dist</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/bootstrap-diff-means-1.png" class="r-plt" alt="Histogram showing the bootstrap distribution of the difference in means between automatic and manual transmission cars, with vertical red dashed lines indicating the 95% confidence interval" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bootstrap-for-correlation">Bootstrap for Correlation<a class="anchor" aria-label="anchor" href="#bootstrap-for-correlation"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original correlation</span></span>
<span><span class="va">cor_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bootstrap correlations</span></span>
<span><span class="va">boot_cor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">n_sims</span> <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_sims</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">cors</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cors</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run bootstrap</span></span>
<span><span class="va">cor_dist</span> <span class="op">&lt;-</span> <span class="fu">boot_cor</span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CI for correlation</span></span>
<span><span class="va">cor_ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">cor_dist</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% CI for correlation:"</span>, <span class="va">cor_ci</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 95% CI for correlation: -0.9276411 -0.7921946</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor_dist</span>, main <span class="op">=</span> <span class="st">"Bootstrap Distribution of Correlation"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Correlation Coefficient"</span>, breaks <span class="op">=</span> <span class="fl">50</span>, col <span class="op">=</span> <span class="st">"lightyellow"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">cor_ci</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">cor_original</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/bootstrap-correlation-1.png" class="r-plt" alt="Histogram showing the bootstrap distribution of the correlation between mpg and weight, with vertical red dashed lines for the 95% confidence interval and a blue line for the original correlation estimate" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<div class="section level3">
<h3 id="multiple-visualizations">Multiple Visualizations<a class="anchor" aria-label="anchor" href="#multiple-visualizations"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate bootstrap data</span></span>
<span><span class="va">boot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_bootstrap.html">tidy_bootstrap</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, .num_sims <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create multiple plots</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">boot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Density Plot"</span>, x <span class="op">=</span> <span class="st">"Value"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">boot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"step"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Probability Plot"</span>, x <span class="op">=</span> <span class="st">"Value"</span>, y <span class="op">=</span> <span class="st">"Cumulative Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">boot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"purple"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sorted Values"</span>, x <span class="op">=</span> <span class="st">"Index"</span>, y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">boot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"QQ Plot"</span>, x <span class="op">=</span> <span class="st">"Theoretical Quantiles"</span>, y <span class="op">=</span> <span class="st">"Sample Quantiles"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine</span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/multiple-viz-1.png" class="r-plt" alt="Four-panel display showing density plot, probability (ECDF) plot, sorted values plot, and Q-Q plot for bootstrap samples, providing comprehensive visualization of bootstrap distribution characteristics" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="custom-visualization-with-ci">Custom Visualization with CI<a class="anchor" aria-label="anchor" href="#custom-visualization-with-ci"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate statistics</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">boot_data</span><span class="op">$</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">boot_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"darkblue"</span>, </span>
<span>             linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"2.5%"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Median"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"97.5%"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Bootstrap Distribution with Confidence Interval"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Statistic Value"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap-analysis_files/figure-html/custom-ci-viz-1.png" class="r-plt" alt="Density plot of bootstrap distribution with annotated 95% confidence interval showing lower bound at 2.5 percentile, median at 50th percentile, and upper bound at 97.5 percentile" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="choose-appropriate-number-of-simulations">1. Choose Appropriate Number of Simulations<a class="anchor" aria-label="anchor" href="#choose-appropriate-number-of-simulations"></a>
</h3>
<p>General guidelines:</p>
<ul>
<li>
<strong>Exploratory:</strong> 1000 simulations</li>
<li>
<strong>Standard analysis:</strong> 2000-5000 simulations</li>
<li>
<strong>Publication/Critical:</strong> 10000+ simulations</li>
</ul>
</div>
<div class="section level3">
<h3 id="verify-bootstrap-convergence">2. Verify Bootstrap Convergence<a class="anchor" aria-label="anchor" href="#verify-bootstrap-convergence"></a>
</h3>
<p>Check stability with different numbers of simulations:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check stability with different numbers of simulations</span></span>
<span><span class="va">n_sims_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">convergence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  n_sims <span class="op">=</span> <span class="va">n_sims_vec</span>,</span>
<span>  mean_est <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ci_lower <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ci_upper <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">n_sims_vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_bootstrap.html">tidy_bootstrap</a></span><span class="op">(</span><span class="va">data</span>, .num_sims <span class="op">=</span> <span class="va">n_sims_vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">boot</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>      mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>      lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>      upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">convergence</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">convergence</span></span>
<span><span class="co">#&gt;   n_sims mean_est ci_lower ci_upper</span></span>
<span><span class="co">#&gt; 1    500 20.11131     10.4     33.9</span></span>
<span><span class="co">#&gt; 2   1000 20.06232     10.4     33.9</span></span>
<span><span class="co">#&gt; 3   2000 20.07139     10.4     33.9</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="consider-sample-size">3. Consider Sample Size<a class="anchor" aria-label="anchor" href="#consider-sample-size"></a>
</h3>
<p>Bootstrap reliability depends on sample size:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Small sample size. Bootstrap may be less reliable."</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Consider: n &gt;= 30 for bootstrap"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sample size:"</span>, <span class="va">n</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample size: 32</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="understand-limitations">4. Understand Limitations<a class="anchor" aria-label="anchor" href="#understand-limitations"></a>
</h3>
<p><strong>Bootstrap works well for:</strong></p>
<ul>
<li>Means, medians, quantiles</li>
<li>Standard errors</li>
<li>Confidence intervals</li>
</ul>
<p><strong>Bootstrap may struggle with:</strong></p>
<ul>
<li>Extreme values (min/max)</li>
<li>Very small samples</li>
<li>Heavily dependent data</li>
<li>Some complex statistics</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="issue-ci-too-wide">Issue: CI Too Wide<a class="anchor" aria-label="anchor" href="#issue-ci-too-wide"></a>
</h3>
<p><strong>Causes:</strong></p>
<ul>
<li>High variability in data</li>
<li>Small sample size</li>
<li>Insufficient bootstrap samples</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Increase bootstrap samples</li>
<li>Check data variability with coefficient of variation:
<code>sd(data) / mean(data)</code>
</li>
<li>Collect more data if possible</li>
</ul>
</div>
<div class="section level3">
<h3 id="issue-long-computation-time">Issue: Long Computation Time<a class="anchor" aria-label="anchor" href="#issue-long-computation-time"></a>
</h3>
<p><strong>Solutions:</strong></p>
<ul>
<li>Reduce number of simulations for exploration</li>
<li>Use parallel processing for large-scale analysis</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steven Sanderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
