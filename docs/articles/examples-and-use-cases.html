<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples and Use Cases • TidyDensity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples and Use Cases">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TidyDensity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-features.html">Advanced Features</a></li>
    <li><a class="dropdown-item" href="../articles/bootstrap-analysis.html">Bootstrap Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/core-concepts.html">Core Concepts</a></li>
    <li><a class="dropdown-item" href="../articles/examples-and-use-cases.html">Examples and Use Cases</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/spsanderson/TidyDensity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Examples and Use Cases</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/spsanderson/TidyDensity/blob/HEAD/vignettes/examples-and-use-cases.Rmd" class="external-link"><code>vignettes/examples-and-use-cases.Rmd</code></a></small>
      <div class="d-none name"><code>examples-and-use-cases.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/spsanderson/TidyDensity" class="external-link">TidyDensity</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Real-world examples demonstrating TidyDensity in action across
various domains and applications.</p>
<div class="section level2">
<h2 id="data-science-and-analytics">Data Science and Analytics<a class="anchor" aria-label="anchor" href="#data-science-and-analytics"></a>
</h2>
<div class="section level3">
<h3 id="example-1-exploring-customer-purchase-amounts">Example 1: Exploring Customer Purchase Amounts<a class="anchor" aria-label="anchor" href="#example-1-exploring-customer-purchase-amounts"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate customer purchase data</span></span>
<span><span class="va">purchases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">800</span>, shape <span class="op">=</span> <span class="fl">2</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,  <span class="co"># Regular customers</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">200</span>, rate <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># Big spenders</span></span>
<span></span>
<span><span class="co"># Fit multiple distributions</span></span>
<span><span class="va">normal_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_normal_param_estimate.html">util_normal_param_estimate</a></span><span class="op">(</span><span class="va">purchases</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gamma_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_gamma_param_estimate.html">util_gamma_param_estimate</a></span><span class="op">(</span><span class="va">purchases</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lognormal_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_lognormal_param_estimate.html">util_lognormal_param_estimate</a></span><span class="op">(</span><span class="va">purchases</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare using AIC</span></span>
<span><span class="va">aic_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Distribution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="st">"Gamma"</span>, <span class="st">"Log-Normal"</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/util_normal_aic.html">util_normal_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">purchases</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/util_gamma_aic.html">util_gamma_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">purchases</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/util_lognormal_aic.html">util_lognormal_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">purchases</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Best distribution</span></span>
<span><span class="va">best_dist</span> <span class="op">&lt;-</span> <span class="va">aic_comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">aic_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Best fitting distribution:"</span>, <span class="va">best_dist</span><span class="op">$</span><span class="va">Distribution</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Best fitting distribution: Log-Normal"</span></span>
<span></span>
<span><span class="co"># Visualize best fit</span></span>
<span><span class="va">gamma_fit</span><span class="op">$</span><span class="va">combined_data_tbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidy_combined_autoplot.html">tidy_combined_autoplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Customer Purchase Distribution"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Best fit:"</span>, <span class="va">best_dist</span><span class="op">$</span><span class="va">Distribution</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Purchase Amount ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/customer-purchases-1.png" class="r-plt" alt="Density plot comparing the empirical distribution of simulated customer purchase data with a fitted gamma distribution, showing how TidyDensity can be used to identify the best-fitting distribution for business data" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-2-ab-test-analysis-with-bootstrap">Example 2: A/B Test Analysis with Bootstrap<a class="anchor" aria-label="anchor" href="#example-2-ab-test-analysis-with-bootstrap"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate A/B test data</span></span>
<span><span class="va">group_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># Control</span></span>
<span><span class="va">group_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">55</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># Treatment</span></span>
<span></span>
<span><span class="co"># Bootstrap confidence intervals</span></span>
<span><span class="va">bootstrap_diff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_sims</span> <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_sims</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">boot_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">group_a</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">group_a</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">boot_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">group_b</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">group_b</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">diffs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_b</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_a</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run bootstrap</span></span>
<span><span class="va">diff_distribution</span> <span class="op">&lt;-</span> <span class="fu">bootstrap_diff</span><span class="op">(</span><span class="fl">5000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate CI</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">diff_distribution</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">diff_distribution</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">boot_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">diff_distribution</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tidy_autoplot.html">tidy_autoplot</a></span><span class="op">(</span><span class="va">boot_tbl</span>, .plot_type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A/B Test: Difference in Means"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"95%% CI: [%.2f, %.2f]"</span>, <span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Difference (B - A)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/ab-test-1.png" class="r-plt" alt="Density plot showing the bootstrap distribution of the difference in means between control and treatment groups in an A/B test, with vertical dashed lines indicating the 95% confidence interval bounds and a solid line at zero for reference" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Decision</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Result: Treatment B is significantly better (p &lt; 0.05)\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Result: Control A is significantly better (p &lt; 0.05)\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Result: No significant difference detected\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Result: No significant difference detected</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-detecting-data-distribution-changes">Example 3: Detecting Data Distribution Changes<a class="anchor" aria-label="anchor" href="#example-3-detecting-data-distribution-changes"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Before and after data</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">after</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">105</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>  <span class="co"># Mean shift and more variance</span></span>
<span></span>
<span><span class="co"># Generate distributions</span></span>
<span><span class="va">dist_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">before</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dist_after</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">after</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine for visualization</span></span>
<span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">dist_before</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>period <span class="op">=</span> <span class="st">"Before"</span><span class="op">)</span>,</span>
<span>  <span class="va">dist_after</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>period <span class="op">=</span> <span class="st">"After"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">period</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution Change Analysis"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Period"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/distribution-change-1.png" class="r-plt" alt="Overlaid density plots comparing 'Before' and 'After' distributions to detect changes in data characteristics such as mean shift and variance changes over time" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Statistical comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Before: Mean ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">before</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", SD ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">sd</span><span class="op">(</span><span class="va">before</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Before: Mean = 98.48 , SD = 15.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"After:  Mean ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">after</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", SD ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">sd</span><span class="op">(</span><span class="va">after</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; After:  Mean = 105.61 , SD = 20.05</span></span>
<span></span>
<span><span class="co"># Test for difference</span></span>
<span><span class="va">t_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">after</span>, <span class="va">before</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"T-test p-value:"</span>, <span class="va">t_test_result</span><span class="op">$</span><span class="va">p.value</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; T-test p-value: 3.793033e-10</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="statistical-analysis">Statistical Analysis<a class="anchor" aria-label="anchor" href="#statistical-analysis"></a>
</h2>
<div class="section level3">
<h3 id="example-4-power-analysis-for-sample-size-determination">Example 4: Power Analysis for Sample Size Determination<a class="anchor" aria-label="anchor" href="#example-4-power-analysis-for-sample-size-determination"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate power analysis</span></span>
<span><span class="va">effect_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1.0</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">sample_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">200</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">power_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>effect_size <span class="op">=</span> <span class="va">effect_sizes</span>, </span>
<span>                             sample_size <span class="op">=</span> <span class="va">sample_sizes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate power for each combination</span></span>
<span><span class="va">calculate_power</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">effect</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span>  <span class="va">significant</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">simulations</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">effect</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="va">significant</span> <span class="op">&lt;-</span> <span class="va">significant</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">significant</span> <span class="op">/</span> <span class="va">simulations</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run for a few key combinations (subset for speed)</span></span>
<span><span class="va">key_combos</span> <span class="op">&lt;-</span> <span class="va">power_results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>, <span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">key_combos</span><span class="op">$</span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">calculate_power</span>, </span>
<span>                           <span class="va">key_combos</span><span class="op">$</span><span class="va">sample_size</span>,</span>
<span>                           <span class="va">key_combos</span><span class="op">$</span><span class="va">effect_size</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">key_combos</span><span class="op">)</span></span>
<span><span class="co">#&gt;     effect_size sample_size power</span></span>
<span><span class="co">#&gt; 1           0.2          30 0.119</span></span>
<span><span class="co">#&gt; 50          0.6          80 0.968</span></span>
<span><span class="co">#&gt; 100         0.2         140 0.389</span></span>
<span><span class="co">#&gt; 150         0.7         190 1.000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-5-distribution-goodness-of-fit-testing">Example 5: Distribution Goodness-of-Fit Testing<a class="anchor" aria-label="anchor" href="#example-5-distribution-goodness-of-fit-testing"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate data (actually from gamma, but test multiple)</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">200</span>, shape <span class="op">=</span> <span class="fl">3</span>, rate <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple distributions and test</span></span>
<span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Normal"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/util_normal_param_estimate.html">util_normal_param_estimate</a></span><span class="op">(</span><span class="va">x</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Gamma"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/util_gamma_param_estimate.html">util_gamma_param_estimate</a></span><span class="op">(</span><span class="va">x</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Weibull"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/util_weibull_param_estimate.html">util_weibull_param_estimate</a></span><span class="op">(</span><span class="va">x</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="st">"Log-Normal"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/util_lognormal_param_estimate.html">util_lognormal_param_estimate</a></span><span class="op">(</span><span class="va">x</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate AIC for each</span></span>
<span><span class="va">aic_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Normal"</span> <span class="op">=</span> <span class="fu"><a href="../reference/util_normal_aic.html">util_normal_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span>,</span>
<span>  <span class="st">"Gamma"</span> <span class="op">=</span> <span class="fu"><a href="../reference/util_gamma_aic.html">util_gamma_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span>,</span>
<span>  <span class="st">"Weibull"</span> <span class="op">=</span> <span class="fu"><a href="../reference/util_weibull_aic.html">util_weibull_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span>,</span>
<span>  <span class="st">"Log-Normal"</span> <span class="op">=</span> <span class="fu"><a href="../reference/util_lognormal_aic.html">util_lognormal_aic</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Results</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Distribution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">aic_results</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="va">aic_results</span>,</span>
<span>  Delta_AIC <span class="op">=</span> <span class="va">aic_results</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">aic_results</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">AIC</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;            Distribution      AIC Delta_AIC</span></span>
<span><span class="co">#&gt; Gamma             Gamma 1009.000  0.000000</span></span>
<span><span class="co">#&gt; Log-Normal   Log-Normal 1013.549  4.549198</span></span>
<span><span class="co">#&gt; Weibull         Weibull 1023.253 14.253167</span></span>
<span><span class="co">#&gt; Normal           Normal 1082.418 73.417824</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBest fitting distribution:"</span>, <span class="va">results_df</span><span class="op">$</span><span class="va">Distribution</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Best fitting distribution: Gamma</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="finance-and-risk-management">Finance and Risk Management<a class="anchor" aria-label="anchor" href="#finance-and-risk-management"></a>
</h2>
<div class="section level3">
<h3 id="example-6-value-at-risk-var-calculation">Example 6: Value at Risk (VaR) Calculation<a class="anchor" aria-label="anchor" href="#example-6-value-at-risk-var-calculation"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate daily returns</span></span>
<span><span class="va">returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">0.001</span>, sd <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>  <span class="co"># 0.1% daily return, 2% volatility</span></span>
<span></span>
<span><span class="co"># Create distribution</span></span>
<span><span class="va">returns_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">returns</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate VaR at different confidence levels</span></span>
<span><span class="va">var_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">returns</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">var_99</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">returns</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">var_995</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">returns</span>, <span class="fl">0.005</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bootstrap for VaR confidence intervals</span></span>
<span><span class="va">boot_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_bootstrap.html">tidy_bootstrap</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">returns</span>, .num_sims <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">boot_var</span> <span class="op">&lt;-</span> <span class="va">boot_returns</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim_number</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>var_95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var_ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">boot_var</span><span class="op">$</span><span class="va">var_95</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Value at Risk (VaR) Analysis\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Value at Risk (VaR) Analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% VaR:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_95</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 95% VaR: -3.199 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"99% VaR:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_99</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 99% VaR: -4.479 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"99.5% VaR:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_995</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 99.5% VaR: -5.064 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n95% CI for 95% VaR: ["</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"%,"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"%]\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% CI for 95% VaR: [ -3.386 %, -2.958 %]</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="fu"><a href="../reference/tidy_autoplot.html">tidy_autoplot</a></span><span class="op">(</span><span class="va">returns_dist</span>, .plot_type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">var_95</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">var_99</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">var_95</span>, y <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"95% VaR"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">var_99</span>, y <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"99% VaR"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Portfolio Returns Distribution with VaR"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Daily Return"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/var-calculation-1.png" class="r-plt" alt="Density plot of simulated daily portfolio returns showing the distribution with vertical dashed lines marking the 95% and 99% Value at Risk thresholds, used for risk management analysis" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-7-option-pricing-with-monte-carlo-simulation">Example 7: Option Pricing with Monte Carlo Simulation<a class="anchor" aria-label="anchor" href="#example-7-option-pricing-with-monte-carlo-simulation"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate stock price paths using GBM</span></span>
<span><span class="va">stock_price_simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">S0</span>, <span class="va">mu</span>, <span class="va">sigma</span>, <span class="va">T</span>, <span class="va">n_steps</span>, <span class="va">n_sims</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dt</span> <span class="op">&lt;-</span> <span class="cn">T</span> <span class="op">/</span> <span class="va">n_steps</span></span>
<span>  <span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n_steps</span> <span class="op">+</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="va">n_sims</span><span class="op">)</span></span>
<span>  <span class="va">paths</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">S0</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">n_steps</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_sims</span><span class="op">)</span></span>
<span>    <span class="va">paths</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">paths</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">mu</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span> <span class="op">*</span> <span class="va">Z</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="va">S0</span> <span class="op">&lt;-</span> <span class="fl">100</span>      <span class="co"># Initial stock price</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">105</span>       <span class="co"># Strike price</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>     <span class="co"># Drift</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>   <span class="co"># Volatility</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">1</span>         <span class="co"># Time to maturity (1 year)</span></span>
<span><span class="va">n_steps</span> <span class="op">&lt;-</span> <span class="fl">252</span> <span class="co"># Daily steps</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Simulate</span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu">stock_price_simulation</span><span class="op">(</span><span class="va">S0</span>, <span class="va">mu</span>, <span class="va">sigma</span>, <span class="cn">T</span>, <span class="va">n_steps</span>, <span class="va">n_sims</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Final prices</span></span>
<span><span class="va">final_prices</span> <span class="op">&lt;-</span> <span class="va">paths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Option payoffs</span></span>
<span><span class="va">call_payoffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">final_prices</span> <span class="op">-</span> <span class="va">K</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">put_payoffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">K</span> <span class="op">-</span> <span class="va">final_prices</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Expected values (discounted)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.03</span>  <span class="co"># Risk-free rate</span></span>
<span><span class="va">call_price</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">call_payoffs</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">r</span> <span class="op">*</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">put_price</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">put_payoffs</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">r</span> <span class="op">*</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Call Option Price:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">call_price</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call Option Price: 8.12</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Put Option Price:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">put_price</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Put Option Price: 7.74</span></span>
<span></span>
<span><span class="co"># Visualize final price distribution</span></span>
<span><span class="va">final_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">final_prices</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tidy_autoplot.html">tidy_autoplot</a></span><span class="op">(</span><span class="va">final_dist</span>, .plot_type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">K</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">S0</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Stock Price Distribution at Maturity"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Stock Price"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/option-pricing-1.png" class="r-plt" alt="Density plot showing the simulated distribution of stock prices at option maturity using geometric Brownian motion, with vertical lines indicating the current stock price and strike price for option pricing analysis" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="quality-control-and-manufacturing">Quality Control and Manufacturing<a class="anchor" aria-label="anchor" href="#quality-control-and-manufacturing"></a>
</h2>
<div class="section level3">
<h3 id="example-8-process-capability-analysis">Example 8: Process Capability Analysis<a class="anchor" aria-label="anchor" href="#example-8-process-capability-analysis"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manufacturing process data</span></span>
<span><span class="va">measurements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Target = 100</span></span>
<span><span class="va">LSL</span> <span class="op">&lt;-</span> <span class="fl">94</span>  <span class="co"># Lower specification limit</span></span>
<span><span class="va">USL</span> <span class="op">&lt;-</span> <span class="fl">106</span> <span class="co"># Upper specification limit</span></span>
<span></span>
<span><span class="co"># Fit distribution</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_normal_param_estimate.html">util_normal_param_estimate</a></span><span class="op">(</span><span class="va">measurements</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mean_est</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">parameter_tbl</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">sd_est</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">parameter_tbl</span><span class="op">$</span><span class="va">stan_dev</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Calculate Cp and Cpk</span></span>
<span><span class="va">Cp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">USL</span> <span class="op">-</span> <span class="va">LSL</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">6</span> <span class="op">*</span> <span class="va">sd_est</span><span class="op">)</span></span>
<span><span class="va">Cpu</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">USL</span> <span class="op">-</span> <span class="va">mean_est</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">sd_est</span><span class="op">)</span></span>
<span><span class="va">Cpl</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mean_est</span> <span class="op">-</span> <span class="va">LSL</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">sd_est</span><span class="op">)</span></span>
<span><span class="va">Cpk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">Cpu</span>, <span class="va">Cpl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Defect rate</span></span>
<span><span class="va">defect_rate</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">LSL</span>, <span class="va">mean_est</span>, <span class="va">sd_est</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">USL</span>, <span class="va">mean_est</span>, <span class="va">sd_est</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Process Capability Analysis\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Process Capability Analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cp:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Cp</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cp: 0.988</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cpk:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Cpk</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cpk: 0.971</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Estimated Defect Rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">defect_rate</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Defect Rate: 0.307 %</span></span>
<span></span>
<span><span class="co"># Interpretation</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">Cpk</span> <span class="op">&gt;=</span> <span class="fl">1.33</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Process capability: GOOD\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">Cpk</span> <span class="op">&gt;=</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Process capability: ADEQUATE\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Process capability: POOR - Action required\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Process capability: POOR - Action required</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">fit</span><span class="op">$</span><span class="va">combined_data_tbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidy_combined_autoplot.html">tidy_combined_autoplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">LSL</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">USL</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Process Capability Analysis"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Cp = %.3f, Cpk = %.3f"</span>, <span class="va">Cp</span>, <span class="va">Cpk</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Measurement"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/process-capability-1.png" class="r-plt" alt="Density plot showing the distribution of manufacturing measurements overlaid with specification limits (LSL and USL) and target value, with process capability indices Cp and Cpk displayed in the subtitle" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-9-control-chart-analysis">Example 9: Control Chart Analysis<a class="anchor" aria-label="anchor" href="#example-9-control-chart-analysis"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate process data with a shift</span></span>
<span><span class="va">n_before</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">n_after</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">before_shift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_before</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">after_shift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_after</span>, mean <span class="op">=</span> <span class="fl">105</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># Process shifted</span></span>
<span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">before_shift</span>, <span class="va">after_shift</span><span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate control limits</span></span>
<span><span class="va">mean_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">before_shift</span><span class="op">)</span></span>
<span><span class="va">sd_val</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">before_shift</span><span class="op">)</span></span>
<span><span class="va">UCL</span> <span class="op">&lt;-</span> <span class="va">mean_val</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sd_val</span></span>
<span><span class="va">LCL</span> <span class="op">&lt;-</span> <span class="va">mean_val</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sd_val</span></span>
<span></span>
<span><span class="co"># Create control chart</span></span>
<span><span class="va">control_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">time</span>, value <span class="op">=</span> <span class="va">all_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">control_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">mean_val</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">UCL</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">LCL</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">n_before</span>, color <span class="op">=</span> <span class="st">"orange"</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"X-bar Control Chart"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Process Shift Detected"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Measurement"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/control-chart-1.png" class="r-plt" alt="X-bar control chart showing process measurements over time with horizontal lines for the mean and upper/lower control limits (UCL/LCL), and a vertical line indicating where a process shift occurred" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="healthcare-and-epidemiology">Healthcare and Epidemiology<a class="anchor" aria-label="anchor" href="#healthcare-and-epidemiology"></a>
</h2>
<div class="section level3">
<h3 id="example-10-disease-outbreak-modeling">Example 10: Disease Outbreak Modeling<a class="anchor" aria-label="anchor" href="#example-10-disease-outbreak-modeling"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model daily case counts with Poisson distribution</span></span>
<span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">90</span></span>
<span><span class="va">baseline_rate</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">peak_rate</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># Simulate outbreak with time-varying rate</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">baseline_rate</span> <span class="op">+</span> <span class="op">(</span><span class="va">peak_rate</span> <span class="op">-</span> <span class="va">baseline_rate</span><span class="op">)</span> <span class="op">*</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">days</span> <span class="op">-</span> <span class="fl">45</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">15</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Gaussian curve</span></span>
<span></span>
<span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Poisson distribution to peak period</span></span>
<span><span class="va">peak_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span><span class="op">[</span><span class="fl">35</span><span class="op">:</span><span class="fl">55</span><span class="op">]</span></span>
<span><span class="va">poisson_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_poisson_param_estimate.html">util_poisson_param_estimate</a></span><span class="op">(</span><span class="va">peak_cases</span>, .auto_gen_empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize time series</span></span>
<span><span class="va">outbreak_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>day <span class="op">=</span> <span class="va">days</span>, cases <span class="op">=</span> <span class="va">cases</span>, expected <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">outbreak_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">expected</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Disease Outbreak Time Series"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Observed Cases vs Expected Rate"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Cases"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Peak analysis</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">poisson_fit</span><span class="op">$</span><span class="va">combined_data_tbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidy_combined_autoplot.html">tidy_combined_autoplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Period Case Distribution"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Daily Cases"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/disease-outbreak-1.png" class="r-plt" alt="Two-panel display showing (1) a time series of daily disease cases with observed counts as points and the expected rate as a red dashed line, and (2) a density plot of the case distribution during the peak outbreak period fitted with a Poisson distribution" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="machine-learning-and-simulation">Machine Learning and Simulation<a class="anchor" aria-label="anchor" href="#machine-learning-and-simulation"></a>
</h2>
<div class="section level3">
<h3 id="example-11-monte-carlo-simulation-for-project-planning">Example 11: Monte Carlo Simulation for Project Planning<a class="anchor" aria-label="anchor" href="#example-11-monte-carlo-simulation-for-project-planning"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Project task duration simulation using triangular distribution</span></span>
<span><span class="va">tasks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  task1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">5</span>, mode <span class="op">=</span> <span class="fl">8</span>, max <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>  task2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">3</span>, mode <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  task3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">7</span>, mode <span class="op">=</span> <span class="fl">10</span>, max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  task4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">2</span>, mode <span class="op">=</span> <span class="fl">4</span>, max <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate total project duration</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">total_durations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_sims</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">task_durations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tasks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">task</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/tidy_triangular.html">tidy_triangular</a></span><span class="op">(</span>.n <span class="op">=</span> <span class="fl">2</span>, .min <span class="op">=</span> <span class="va">task</span><span class="op">$</span><span class="va">min</span>, .max <span class="op">=</span> <span class="va">task</span><span class="op">$</span><span class="va">max</span>, .mode <span class="op">=</span> <span class="va">task</span><span class="op">$</span><span class="va">mode</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">total_durations</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">task_durations</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Analyze results</span></span>
<span><span class="va">duration_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">total_durations</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">percentiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">total_durations</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Project Duration Analysis\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Project Duration Analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"10th percentile (optimistic):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">percentiles</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"days\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 10th percentile (optimistic): 27.2 days</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"50th percentile (median):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">percentiles</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"days\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 50th percentile (median): 32.3 days</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"90th percentile (pessimistic):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">percentiles</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"days\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 90th percentile (pessimistic): 37.7 days</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="fu"><a href="../reference/tidy_autoplot.html">tidy_autoplot</a></span><span class="op">(</span><span class="va">duration_dist</span>, .plot_type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">percentiles</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"green"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">percentiles</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">percentiles</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Project Duration Distribution"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Monte Carlo Simulation (5000 iterations)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Total Duration (days)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/project-planning-1.png" class="r-plt" alt="Density plot showing the Monte Carlo simulated distribution of total project duration with vertical lines marking the 10th percentile (optimistic), 50th percentile (median), and 90th percentile (pessimistic) estimates" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="education-and-teaching">Education and Teaching<a class="anchor" aria-label="anchor" href="#education-and-teaching"></a>
</h2>
<div class="section level3">
<h3 id="example-12-demonstrating-central-limit-theorem">Example 12: Demonstrating Central Limit Theorem<a class="anchor" aria-label="anchor" href="#example-12-demonstrating-central-limit-theorem"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show CLT with different source distributions</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">sample_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demonstrate_clt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">source_dist_func</span>, <span class="va">sample_size</span>, <span class="va">n_samples</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_samples</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_samples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu">source_dist_func</span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span></span>
<span>    <span class="va">sample_means</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sample_means</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Source: Uniform distribution</span></span>
<span><span class="va">uniform_source</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate for different sample sizes</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sample_sizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">means</span> <span class="op">&lt;-</span> <span class="fu">demonstrate_clt</span><span class="op">(</span><span class="va">uniform_source</span>, <span class="va">n</span>, <span class="va">n_samples</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">means</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_size <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine and plot</span></span>
<span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sample_size</span>, scales <span class="op">=</span> <span class="st">"free"</span>, </span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>sample_size <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"n ="</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Central Limit Theorem Demonstration"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Sample Means from Uniform(0,1) Distribution"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Sample Mean"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples-and-use-cases_files/figure-html/central-limit-theorem-1.png" class="r-plt" alt="Four-panel density plot showing how the distribution of sample means from a uniform distribution becomes more normal as sample size increases from n=5 to n=50, demonstrating the Central Limit Theorem" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="tips-for-your-own-use-cases">Tips for Your Own Use Cases<a class="anchor" aria-label="anchor" href="#tips-for-your-own-use-cases"></a>
</h2>
<div class="section level3">
<h3 id="start-with-exploration">1. Start with Exploration<a class="anchor" aria-label="anchor" href="#start-with-exploration"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Explore your data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try empirical distribution</span></span>
<span><span class="va">emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_empirical.html">tidy_empirical</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">your_data</span>, .num_sims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tidy_autoplot.html">tidy_autoplot</a></span><span class="op">(</span><span class="va">emp</span>, .plot_type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="try-multiple-distributions">2. Try Multiple Distributions<a class="anchor" aria-label="anchor" href="#try-multiple-distributions"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Systematic comparison</span></span>
<span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span>, <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="va">aics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">distributions</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">func</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"util_"</span>, <span class="va">d</span>, <span class="st">"_aic"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">func</span><span class="op">(</span>.x <span class="op">=</span> <span class="va">your_data</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">best</span> <span class="op">&lt;-</span> <span class="va">distributions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">aics</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validate-with-visualization">3. Validate with Visualization<a class="anchor" aria-label="anchor" href="#validate-with-visualization"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Always visualize</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"util_"</span>, <span class="va">best</span>, <span class="st">"_param_estimate"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span></span>
<span>  <span class="va">your_data</span>,</span>
<span>  .auto_gen_empirical <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span><span class="op">$</span><span class="va">combined_data_tbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidy_combined_autoplot.html">tidy_combined_autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-bootstrap-for-uncertainty">4. Use Bootstrap for Uncertainty<a class="anchor" aria-label="anchor" href="#use-bootstrap-for-uncertainty"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add bootstrap confidence intervals</span></span>
<span><span class="va">boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_bootstrap.html">tidy_bootstrap</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">your_data</span>, .num_sims <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">boot</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bootstrap_unnest_tbl.html">bootstrap_unnest_tbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="key-takeaways">Key Takeaways<a class="anchor" aria-label="anchor" href="#key-takeaways"></a>
</h2>
<div class="section level3">
<h3 id="distribution-fitting-is-essential">1. Distribution Fitting is Essential<a class="anchor" aria-label="anchor" href="#distribution-fitting-is-essential"></a>
</h3>
<p>Use AIC to compare multiple candidate distributions and select the
best fit for your data.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-provides-robust-uncertainty">2. Bootstrap Provides Robust Uncertainty<a class="anchor" aria-label="anchor" href="#bootstrap-provides-robust-uncertainty"></a>
</h3>
<p>When parametric assumptions are uncertain, bootstrap resampling gives
reliable confidence intervals.</p>
</div>
<div class="section level3">
<h3 id="visualization-validates-analysis">3. Visualization Validates Analysis<a class="anchor" aria-label="anchor" href="#visualization-validates-analysis"></a>
</h3>
<p>Always plot your results to verify that fitted distributions match
the empirical data.</p>
</div>
<div class="section level3">
<h3 id="tidydensity-integrates-with-tidyverse">4. TidyDensity Integrates with Tidyverse<a class="anchor" aria-label="anchor" href="#tidydensity-integrates-with-tidyverse"></a>
</h3>
<p>Leverage dplyr, ggplot2, and other tidyverse tools for seamless
analysis workflows.</p>
</div>
<div class="section level3">
<h3 id="domain-knowledge-guides-choices">5. Domain Knowledge Guides Choices<a class="anchor" aria-label="anchor" href="#domain-knowledge-guides-choices"></a>
</h3>
<p>Let your understanding of the problem domain inform distribution
selection and interpretation.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steven Sanderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
